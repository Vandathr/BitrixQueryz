Перем масПоляДляПроверкиНаЗаполнение;	
Перем масКоманды;	
	
	
Процедура КнопкаВыполнитьНажатие(Кнопка)
	
	стрСообщение = "";
	
	Для Каждого элМас Из масПоляДляПроверкиНаЗаполнение Цикл
		
		Если Не ЗначениеЗаполнено(элМас.Значение) Тогда
			
			стрСообщение = стрСообщение + "Поле " + элМас.Имя + " не заполнено" + Символы.ПС;
			
		КонецЕсли;
				
	КонецЦикла;
	
	Если ЗначениеЗаполнено(стрСообщение) Тогда		
		Предупреждение(стрСообщение, , "Поля не заполнены");
		Возврат;
	КонецЕсли;	
	
	
	Если Не масКоманды[ЭлементыФормы.Команда.Значение] = Неопределено Тогда
					
		РезультирующаяТаблица = ОсновнаяРабота(СобратьUrl(), СобратьPostЗапрос());
		
		ЭлементыФормы.РезультирующаяТаблица.СоздатьКолонки();
		
	КонецЕсли;
	
КонецПроцедуры


Процедура КомандаПриИзменении(Элемент)
		
	Если Не масКоманды[ЭлементыФормы.Команда.Значение] = Неопределено Тогда
		
		АргументыЗапроса = СоздатьТаблицуАргументов(масКоманды[ЭлементыФормы.Команда.Значение].соотвАргументы);
		ЭлементыФормы.АргументыЗапроса.СоздатьКолонки();
		
		Если масКоманды[ЭлементыФормы.Команда.Значение].Свойство("стрJSON") Тогда		
			ТелоЗапроса = ЗаполнитьJsonПараметрами(масКоманды[ЭлементыФормы.Команда.Значение].стрJSON, 
			масКоманды[ЭлементыФормы.Команда.Значение].соотвАргументы);
		КонецЕсли;
		
		
		
	КонецЕсли;
	
КонецПроцедуры


Функция СобратьUrl()

	 Возврат "/rest/" + ИдентификаторПользователя + "/" + Ключ + "/" + масКоманды[ЭлементыФормы.Команда.Значение].стрUrl;
	 	 
 КонецФункции

 
 
 Функция СобратьPostЗапрос()
	 
	 результат = "";
	 
	 Если АргументыЗапроса.Количество() < 1 Тогда
		 Возврат результат;
	 КонецЕсли;
	 
	 Если ЗначениеЗаполнено(АргументыЗапроса[0].Значение) Тогда
		 результат = результат + АргументыЗапроса[0].Название + "=" + АргументыЗапроса[0].Значение;
	 КонецЕсли;
	 
	 
	 Если АргументыЗапроса.Количество() > 1 Тогда
		 
		 Для Счетчик = 1 По АргументыЗапроса.Количество() - 1 Цикл
			 
			 Если ЗначениеЗаполнено(АргументыЗапроса[Счетчик].Значение) Тогда			
				 результат = результат + "&" + АргументыЗапроса[Счетчик].Название + "=" + АргументыЗапроса[Счетчик].Значение;
			 КонецЕсли;
			 
		 КонецЦикла;
		 
	 КонецЕсли;
	 	 
	 Возврат результат;
	 
 КонецФункции
  
  

Функция ЗаполнитьJsonПараметрами(аргСтрJson, аргСтрукПараметры)
	
	стрЗаполненныйJson = аргСтрJson;
	
		
	Для Каждого элСтрук Из аргСтрукПараметры Цикл	
		стрЗаполненныйJson = СтрЗаменить(стрЗаполненныйJson, "%" + элСтрук.Ключ + "%", ОбработатьСтроку(элСтрук.Значение));		
	КонецЦикла;
	
	
	Возврат стрЗаполненныйJson; 
	
КонецФункции


Функция ОбработатьСтроку(аргСтрока)
	
	стрКавычка = """"; 
	
	Попытка
		преобразование = Число(аргСтрока);
	Исключение
		Возврат стрКавычка + аргСтрока + стрКавычка;
	КонецПопытки;
	
	Возврат аргСтрока;
	
КонецФункции



масПоляДляПроверкиНаЗаполнение = Новый Массив;

масПоляДляПроверкиНаЗаполнение.Добавить(ЭлементыФормы.ИдентификаторПользователя);
масПоляДляПроверкиНаЗаполнение.Добавить(ЭлементыФормы.Ключ);




масКоманды = Новый Массив;
масКоманды.Добавить(Неопределено);


СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Получение доступных разрешении");
СтрукАргументы.Вставить("стрUrl", "scope.json");

СоотвАргументы = Новый Соответствие; 
СоотвАргументы.Вставить("full", "false");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);


СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Проверка метода на доступность");
СтрукАргументы.Вставить("стрUrl", "method.get.json");

СоотвАргументы = Новый Соответствие; 
СоотвАргументы.Вставить("name", "events");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);



СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Пользователи в текущем подразделении");
СтрукАргументы.Вставить("стрUrl", "im.department.colleagues.list.json");

СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("USER_DATA", "Y"); 
СоотвАргументы.Вставить("OFFSET", "0");
СоотвАргументы.Вставить("LIMIT", "100");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);



СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Поиск пользователей по имени");
СтрукАргументы.Вставить("стрUrl", "im.search.user.list.json");

СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("FIND", "Анна"); 
СоотвАргументы.Вставить("OFFSET", "0");
СоотвАргументы.Вставить("LIMIT", "100");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);



СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Поиск чата по названию");
СтрукАргументы.Вставить("стрUrl", "im.search.chat.list.json");

СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("FIND", "Анна"); 
СоотвАргументы.Вставить("OFFSET", "0");
СоотвАргументы.Вставить("LIMIT", "100");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);



СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Поиск подразделения по названию");
СтрукАргументы.Вставить("стрUrl", "im.search.department.list.json");

СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("FIND", "Отдел");
СоотвАргументы.Вставить("USER_DATA", "Y");
СоотвАргументы.Вставить("OFFSET", "0");
СоотвАргументы.Вставить("LIMIT", "100");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);



СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Данные подразделения по Id");
СтрукАргументы.Вставить("стрUrl", "im.department.get.json");

СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("ID", "[5]");
СоотвАргументы.Вставить("USER_DATA", "Y");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);



СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Менеджеры подразделения по его Id");
СтрукАргументы.Вставить("стрUrl", "im.department.managers.get.json");

СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("ID", "[5]");
СоотвАргументы.Вставить("USER_DATA", "Y");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);



СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Сотрудники подразделения по его Id");
СтрукАргументы.Вставить("стрUrl", "im.department.employees.get.json");

СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("ID", "[5]");
СоотвАргументы.Вставить("USER_DATA", "Y");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);



СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Отправить сообщение");
СтрукАргументы.Вставить("стрUrl", "im.message.add.json");

СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("DIALOG_ID", "chat36393");
СоотвАргументы.Вставить("MESSAGE", "Тестове сообщение из 1С" + ТекущаяДата());
СоотвАргументы.Вставить("SYSTEM", "Y");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);



СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Список пользователей чата");
СтрукАргументы.Вставить("стрUrl", "im.chat.user.list.json");

СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("CHAT_ID", "36393");


СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);


СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Поля счёта");
СтрукАргументы.Вставить("стрUrl", "crm.invoice.fields.json");

СоотвАргументы = Новый Соответствие;

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);

СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Поиск компании");
СтрукАргументы.Вставить("стрUrl", "crm.company.list.json");

СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("FILTER[TITLE]", "Специндустрия - тест");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);


СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Поиск сделки");
СтрукАргументы.Вставить("стрUrl", "crm.deal.list.json");

СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("FILTER[TITLE]", " Тест для счета от 30.09.2024");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);



СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Поиск контакта");
СтрукАргументы.Вставить("стрUrl", "crm.contact.list.json");



СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("FILTER[NAME]", "Специндустрия, ИНН 1832102020");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);


СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Получить платёжные системы");
СтрукАргументы.Вставить("стрUrl", "crm.paysystem.list.json");

СоотвАргументы = Новый Соответствие;

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);


СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Получить документы");
СтрукАргументы.Вставить("стрUrl", "documentgenerator.list.json");

СоотвАргументы = Новый Соответствие;

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);


СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Получить платёжные системы");
СтрукАргументы.Вставить("стрUrl", "crm.paysystem.list.json");

СоотвАргументы = Новый Соответствие;

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);


СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Получить типы плательщиков");
СтрукАргументы.Вставить("стрUrl", "crm.persontype.list.json");

СоотвАргументы = Новый Соответствие;

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);


СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Изменить сделку");
СтрукАргументы.Вставить("стрUrl", "crm.deal.update.json");

СоотвАргументы = Новый Соответствие;

СоотвАргументы.Вставить("ID", "26141");
СоотвАргументы.Вставить("FIELDS[COMMENTS]", "Тестируем 2");
СоотвАргументы.Вставить("FIELDS[STAGE_ID]", Неопределено);
СоотвАргументы.Вставить("FIELDS[STAGE_SEMANTIC]", Неопределено);

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);


СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Поля сделки");
СтрукАргументы.Вставить("стрUrl", "crm.deal.fields.json");

СоотвАргументы = Новый Соответствие;

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);


СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Типы статусов сделок");
СтрукАргументы.Вставить("стрUrl", "crm.dealcategory.stage.list.json");

СоотвАргументы = Новый Соответствие;

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);



СтрукАргументы = Новый Структура;
СтрукАргументы.Вставить("стрНазвание", "Получить ссылку для отправки файла");
СтрукАргументы.Вставить("стрUrl", "disk.folder.uploadfile.json");

СоотвАргументы = Новый Соответствие;
СоотвАргументы.Вставить("id", "428571");

СтрукАргументы.Вставить("соотвАргументы", СоотвАргументы);
масКоманды.Добавить(СтрукАргументы);



ЭлементыФормы.Команда.СписокВыбора.Добавить(0, ""); 

Для Счётчик = 1 По масКоманды.Количество() - 1 Цикл
	ЭлементыФормы.Команда.СписокВыбора.Добавить(Счётчик, масКоманды[Счётчик].стрНазвание);			
КонецЦикла;


